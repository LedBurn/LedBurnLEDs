#!/usr/bin/env python

import pygame

from Simulator.SheepSimulator import SheepSimulator

from UIElements.BigSheep12 import BigSheep12
from UIElements.BigSheep34 import BigSheep34
from UIElements.SmallSheep import SmallSheep
from UIElements.Signs import Signs
from UIElements.Flower import Flower

from Animations.AfterPeakAnimations import *
from Animations.ColoringAnimations import *
from Animations.PeakAnimations import *

pygame.init()
clock = pygame.time.Clock()

# simulator
smallSheep = SmallSheep()
bigSheep12 = BigSheep12()
bigSheep34 = BigSheep34()
signs = Signs()
flower = Flower()
simulator = SheepSimulator()

# audio
FILE_NAME = "ChristmasDubstep"
INPUT_FILE = "Music_Samples/" + FILE_NAME + ".mp3"
beat_times = [0.0, 0.185759637188, 0.928798185941, 1.76471655329, 2.62385487528, 3.48299319728, 4.34213151927, 5.20126984127, 6.06040816327, 6.89632653061, 7.75546485261, 8.6146031746, 9.4737414966, 10.3328798186, 11.1687981859, 12.0511564626, 12.9102947846, 13.7694331066, 14.6053514739, 15.4644897959, 16.3236281179, 17.1827664399, 18.0419047619, 18.9010430839, 19.7601814059, 20.6193197279, 21.4784580499, 22.3375963719, 23.1967346939, 24.0558730159, 24.8917913832, 25.7509297052, 26.6100680272, 27.4692063492, 28.3283446712, 29.1874829932, 30.0466213152, 30.9057596372, 31.7648979592, 32.6240362812, 33.4831746032, 34.3423129252, 35.1782312925, 36.0373696145, 36.8965079365, 37.7556462585, 38.6147845805, 39.4739229025, 40.3330612245, 41.1921995465, 42.0513378685, 42.9104761905, 43.7696145125, 44.6287528345, 45.4878911565, 46.3470294785, 47.2061678005, 48.0653061224, 48.9244444444, 49.8068027211, 50.6659410431, 51.4786394558, 52.3377777778, 53.1969160998, 54.0560544218, 54.8223129252, 55.7511111111, 56.6102494331, 57.4693877551, 58.3285260771, 59.1876643991, 60.0468027211, 60.9059410431, 61.6721995465, 62.6242176871, 63.4833560091, 64.3424943311, 65.2016326531, 66.0607709751, 66.9199092971, 67.779047619, 68.638185941, 69.4741043084, 70.3332426304, 71.1923809524, 72.0515192744, 72.9106575964, 73.7697959184, 74.6289342404, 75.4880725624, 76.3472108844, 77.2063492063, 78.0422675737, 78.9246258503, 79.7837641723, 80.6429024943, 81.5020408163, 82.3611791383, 83.2203174603, 84.0794557823, 84.9153741497, 85.751292517, 86.610430839, 87.469569161, 88.328707483, 89.187845805, 90.046984127, 90.906122449, 91.765260771, 92.624399093, 93.4603174603, 94.342675737, 95.201814059, 96.060952381, 96.8968707483, 97.7560090703, 98.6151473923, 99.4742857143, 100.333424036, 101.192562358, 102.05170068, 102.910839002, 103.769977324, 104.629115646, 105.488253968, 106.324172336, 107.183310658, 108.04244898, 108.901587302, 109.760725624, 110.619863946, 111.479002268, 112.33814059, 113.197278912, 114.033197279, 114.915555556, 115.774693878, 116.6338322, 117.469750567, 118.328888889, 119.188027211, 120.047165533, 120.906303855, 121.765442177, 122.624580499, 123.506938776, 124.366077098, 125.22521542, 126.084353741, 126.920272109, 127.756190476, 128.615328798, 129.47446712, 130.333605442, 131.192743764, 132.051882086, 132.911020408, 133.77015873, 134.629297052, 135.488435374, 136.347573696, 137.1138322, 138.042630385, 138.901768707, 139.760907029, 140.620045351, 141.479183673, 142.338321995, 143.197460317, 144.056598639, 144.915736961, 145.774875283, 146.610793651, 147.493151927, 148.329070295, 149.188208617, 150.047346939, 150.906485261, 151.765623583, 152.624761905, 153.483900227]
#onset_times = [0.0, 0.116099773243, 0.232199546485, 0.325079365079, 0.510839002268, 0.719818594104, 0.95201814059, 1.16099773243, 1.39319727891, 1.60217687075, 1.81115646259, 1.95047619048, 2.04335600907, 2.22911564626, 2.4380952381, 2.67029478458, 2.80961451247, 2.87927437642, 3.1114739229, 3.29723356009, 3.52943310658, 3.66875283447, 3.94739229025, 4.15637188209, 4.36535147392, 4.52789115646, 4.59755102041, 4.7368707483, 4.80653061224, 5.01551020408, 5.22448979592, 5.38702947846, 5.66566893424, 5.87464852608, 6.08362811791, 6.24616780045, 6.3158276644, 6.52480725624, 6.73378684807, 6.94276643991, 7.0820861678, 7.17496598639, 7.38394557823, 7.59292517007, 7.77868480726, 8.03410430839, 8.24308390023, 8.45206349206, 8.6610430839, 8.80036281179, 8.89324263039, 9.10222222222, 9.28798185941, 9.40408163265, 9.5201814059, 9.75238095238, 9.96136054422, 10.1703401361, 10.3793197279, 10.5186394558, 10.6115192744, 10.8204988662, 11.0062585034, 11.2152380952, 11.4706575964, 11.6796371882, 11.8653968254, 12.0743764172, 12.2369160998, 12.3297959184, 12.5155555556, 12.7245351474, 12.8406349206, 12.9567346939, 13.3979138322, 13.4907936508, 13.5836734694, 13.7926530612, 13.9551927438, 14.2338321995, 14.4428117914, 14.6517913832, 14.8839909297, 15.0929705215, 15.3019501134, 15.5109297052, 15.6734693878, 15.7431292517, 15.9521088435, 16.1610884354, 16.2771882086, 16.3700680272, 16.6022675737, 16.8344671202, 17.0202267574, 17.2292063492, 17.3685260771, 17.4614058957, 17.6703854875, 17.8793650794, 18.0883446712, 18.3205442177, 18.5295238095, 18.7385034014, 18.9474829932, 19.0868027211, 19.1796825397, 19.3886621315, 19.5744217687, 19.7137414966, 19.8066213152, 20.0388208617, 20.2710204082, 20.4567800454, 20.6657596372, 20.8050793651, 20.8979591837, 21.1069387755, 21.2926984127, 21.5016780045, 21.9660770975, 22.1750566893, 22.3840362812, 22.5233560091, 22.6162358277, 22.8019954649, 23.0109750567, 23.1270748299, 23.2199546485, 23.6843537415, 23.8701133787, 24.0790929705, 24.2416326531, 24.311292517, 24.5202721088, 24.7292517007, 24.9382312925, 25.170430839, 25.3794104308, 25.5883900227, 25.7973696145, 25.9599092971, 26.029569161, 26.2385487528, 26.4475283447, 26.5636281179, 26.6565079365, 26.888707483, 27.1209070295, 27.3066666667, 27.5156462585, 27.747845805, 27.9568253968, 28.1658049887, 28.3747845805, 28.8159637188, 29.2339229025, 29.466122449, 29.6751020408, 29.8840816327, 30.0001814059, 30.0930612245, 30.5342403628, 30.7432199546, 30.9521995465, 31.0915192744, 31.3933786848, 31.579138322, 31.7184580499, 31.8113378685, 32.2525170068, 32.4614965986, 32.6704761905, 32.8097959184, 32.902675737, 33.0884353741, 33.297414966, 33.4135147392, 33.5063945578, 33.9707936508, 34.156553288, 34.3655328798, 34.5280725624, 34.5977324263, 34.8067120181, 35.01569161, 35.1550113379, 35.2246712018, 35.4568707483, 35.6658503401, 35.874829932, 36.0838095238, 36.2231292517, 36.5249886621, 36.66430839, 36.733968254, 36.8500680272, 36.9429478458, 37.4073469388, 37.5002267574, 37.593106576, 37.8020861678, 37.9646258503, 38.0342857143, 38.2432653061, 38.4290249433, 38.6612244898, 38.8934240363, 39.1024036281, 39.31138322, 39.5203628118, 39.6596825397, 39.7525623583, 39.9615419501, 40.1473015873, 40.2634013605, 40.3795011338, 40.6117006803, 40.8206802721, 41.0296598639, 41.2386394558, 41.3779591837, 41.6565986395, 41.8655782313, 42.0745578231, 42.3299773243, 42.5389569161, 42.7479365079, 42.9336961451, 43.1891156463, 43.3748752834, 43.6070748299, 43.7928344671, 44.0250340136, 44.2340136054, 44.6751927438, 44.8841723356, 45.0931519274, 45.3021315193, 45.5111111111, 45.7433106576, 45.9522902494, 46.3934693878, 46.6024489796, 46.8114285714, 47.0204081633, 47.2293877551, 47.4615873016, 47.6705668934, 48.1117460317, 48.5297052154, 48.9476643991, 49.3888435374, 49.8300226757, 50.2479818594, 50.6891609977, 51.5250793651, 51.7572789116, 51.9662585034, 52.1520181406, 52.3609977324, 52.8253968254, 53.0111564626, 53.2433560091, 53.4523356009, 53.6613151927, 53.8702947846, 53.9863945578, 54.1024943311, 54.5436734694, 54.7294331066, 54.8455328798, 54.9616326531, 55.1706122449, 55.3795918367, 55.5885714286, 55.7975510204, 56.0529705215, 56.2387301587, 56.6566893424, 56.8192290249, 56.9817687075, 57.1210884354, 57.3068480726, 57.4229478458, 57.5158276644, 57.8873469388, 58.3749659864, 58.6071655329, 58.8161451247, 59.0251247166, 59.2341043084, 59.6752834467, 59.8842630385, 60.0932426304, 60.3254421769, 60.5344217687, 60.7434013605, 60.8595011338, 60.9523809524, 61.3935600907, 61.6025396825, 61.7186394558, 61.8115192744, 62.0204988662, 62.229478458, 62.4616780045, 62.6474376417, 62.9028571429, 63.3208163265, 63.5065759637, 63.6691156463, 63.8548752834, 63.9709750567, 64.1567346939, 64.3889342404, 65.2248526077, 65.6892517007, 65.8982312925, 66.0839909297, 66.3161904762, 66.525170068, 66.7341496599, 66.8502494331, 66.9431292517, 67.1753287982, 67.38430839, 67.5932879819, 67.7093877551, 67.8022675737, 68.0344671202, 68.243446712, 68.4524263039, 68.5685260771, 68.6614058957, 68.8936054422, 69.102585034, 69.3115646259, 69.4276643991, 69.5205442177, 69.7527437642, 69.961723356, 70.1707029478, 70.3796825397, 70.6118820862, 70.820861678, 71.0298412698, 71.1459410431, 71.2388208617, 71.4710204082, 71.68, 71.8889795918, 71.9818594104, 72.0979591837, 72.539138322, 72.7481179138, 72.8642176871, 72.9570975057, 73.398276644, 73.6072562358, 73.7233560091, 73.8162358277, 74.0252154195, 74.257414966, 74.4663945578, 74.5592743764, 74.6753741497, 75.116553288, 75.3023129252, 75.4184126984, 75.5345124717, 75.7434920635, 75.97569161, 76.1846712018, 76.3007709751, 76.370430839, 76.6026303855, 76.8116099773, 77.0438095238, 77.229569161, 77.3921088435, 77.4617687075, 77.6707482993, 77.8797278912, 77.9958276644, 78.088707483, 78.3209070295, 78.5298866213, 78.6459863946, 78.7388662132, 78.8549659864, 78.9710657596, 79.8302040816, 80.2481632653, 82.384399093, 82.8255782313, 83.2667573696, 83.7079365079, 84.5438548753, 84.961814059, 85.3797732426, 85.7977324263, 85.9370521542, 86.0299319728, 86.2389115646, 86.4478911565, 86.6568707483, 86.8890702948, 87.0980498866, 87.3070294785, 87.5160090703, 87.6553287982, 87.7482086168, 87.9571882086, 88.1429478458, 88.2822675737, 88.3751473923, 88.6073469388, 88.723446712, 88.9324263039, 89.0253061224, 89.2342857143, 89.3736054422, 89.4664852608, 89.652244898, 89.8612244898, 90.0702040816, 90.3256235828, 90.441723356, 90.5346031746, 90.7435827664, 90.9525623583, 91.0918820862, 91.1847619048, 91.370521542, 91.5795011338, 91.695600907, 91.8117006803, 92.0439002268, 92.16, 92.2528798186, 92.4618594104, 92.6476190476, 92.8101587302, 93.0887981859, 93.2977777778, 93.5067573696, 93.7389569161, 93.878276644, 93.9711564626, 94.1569160998, 94.3658956916, 94.5284353741, 94.5980952381, 94.8070748299, 95.0160544218, 95.132154195, 95.2250340136, 95.4572335601, 95.596553288, 95.6894331066, 95.7823129252, 95.8751927438, 96.0841723356, 96.2467120181, 96.3163718821, 96.5253514739, 96.7343310658, 96.9433106576, 97.1755102041, 97.3844897959, 97.5934693878, 97.8024489796, 97.9417687075, 98.0346485261, 98.2436281179, 98.4293877551, 98.568707483, 98.6615873016, 98.8937868481, 99.033106576, 99.3117460317, 99.5207256236, 99.6600453515, 99.7529251701, 99.9386848073, 100.147664399, 100.356643991, 100.612063492, 100.821043084, 101.030022676, 101.239002268, 101.378321995, 101.471201814, 101.656961451, 101.865941043, 101.982040816, 102.09814059, 102.330340136, 102.446439909, 102.539319728, 102.74829932, 102.934058957, 103.096598639, 103.375238095, 103.584217687, 103.793197279, 104.234376417, 104.652335601, 104.814875283, 104.884535147, 105.023854875, 105.116734694, 105.302494331, 105.418594104, 105.511473923, 105.882993197, 105.975873016, 106.370612245, 106.533151927, 106.602811791, 106.811791383, 107.020770975, 107.160090703, 107.229750567, 107.461950113, 107.670929705, 107.879909297, 108.088888889, 108.228208617, 108.321088435, 108.530068027, 108.715827664, 108.855147392, 108.948027211, 109.319546485, 109.389206349, 109.598185941, 109.807165533, 109.946485261, 110.039365079, 110.248344671, 110.434104308, 110.573424036, 110.666303855, 111.107482993, 111.316462585, 111.525442177, 111.664761905, 111.943401361, 112.082721088, 112.175600907, 112.384580499, 112.825759637, 113.034739229, 113.220498866, 113.383038549, 113.661678005, 113.870657596, 114.079637188, 114.311836735, 114.520816327, 114.729795918, 114.93877551, 115.101315193, 115.379954649, 115.58893424, 115.705034014, 115.797913832, 116.030113379, 116.169433107, 116.448072562, 116.657052154, 116.819591837, 116.889251701, 117.098231293, 117.307210884, 117.516190476, 117.748390023, 117.957369615, 118.166349206, 118.375328798, 118.607528345, 118.793287982, 119.025487528, 119.23446712, 119.466666667, 119.58276644, 119.675646259, 120.093605442, 120.325804989, 120.511564626, 120.743764172, 120.952743764, 121.184943311, 121.370702948, 121.811882086, 122.044081633, 122.22984127, 122.462040816, 122.671020408, 122.88, 123.019319728, 123.112199546, 123.553378685, 123.948117914, 124.389297052, 124.807256236, 125.271655329, 125.689614512, 126.130793651, 126.316553288, 126.943492063, 127.17569161, 127.384671202, 127.593650794, 127.802630385, 128.243809524, 128.452789116, 128.661768707, 128.893968254, 129.102947846, 129.311927438, 129.428027211, 129.520907029, 129.962086168, 130.17106576, 130.287165533, 130.589024943, 130.798004535, 131.030204082, 131.215963719, 131.47138322, 131.889342404, 132.098321995, 132.284081633, 132.400181406, 132.539501134, 132.725260771, 132.934240363, 133.375419501, 133.816598639, 134.025578231, 134.234557823, 134.443537415, 134.652517007, 135.093696145, 135.302675737, 135.511655329, 135.743854875, 135.952834467, 136.161814059, 136.277913832, 136.394013605, 136.811972789, 137.020952381, 137.137052154, 137.253151927, 137.462131519, 137.671111111, 137.880090703, 138.089070295, 138.321269841, 138.739229025, 138.948208617, 139.133968254, 139.296507937, 139.389387755, 139.598367347, 139.71446712, 139.807346939, 140.248526077, 140.666485261, 141.107664399, 141.316643991, 141.525623583, 141.966802721, 142.175782313, 142.291882086, 142.384761905, 142.593741497, 142.825941043, 143.034920635, 143.127800454, 143.243900227, 143.476099773, 143.685079365, 143.894058957, 143.986938776, 144.103038549, 144.544217687, 144.729977324, 144.846077098, 144.938956916, 145.171156463, 145.380136054, 145.612335601, 145.821315193, 146.030294785, 146.239274376, 146.448253968, 146.564353741, 146.65723356, 146.889433107, 147.098412698, 147.214512472, 147.30739229, 147.423492063, 147.516371882, 147.95755102, 148.166530612, 148.282630385, 148.375510204, 148.607709751, 148.816689342, 148.932789116, 149.025668934, 149.141768707, 149.234648526, 149.675827664, 149.884807256, 150.000907029, 150.093786848, 150.325986395, 150.534965986, 150.743945578, 150.860045351, 150.95292517, 151.394104308, 151.6030839, 151.719183673, 151.812063492, 151.928163265, 152.044263039, 152.25324263, 152.462222222, 152.671201814, 152.880181406, 152.996281179, 153.089160998, 153.29814059, 153.414240363, 153.530340136, 153.762539683, 153.94829932, 154.064399093, 154.180498866, 154.273378685, 154.389478458, 156.107755102, 156.966893424, 157.826031746, 158.685170068]
#onset_times = [0.0, 0.139319727891, 0.557278911565, 0.743038548753, 0.975238095238, 1.16099773243, 1.39319727891, 1.6253968254, 1.81115646259, 2.27555555556, 2.46131519274, 2.69351473923, 2.83283446712, 2.87927437642, 3.1114739229, 3.29723356009, 3.34367346939, 3.52943310658, 3.66875283447, 3.76163265306, 3.99383219955, 4.17959183673, 4.41179138322, 4.59755102041, 4.82975056689, 5.01551020408, 5.24770975057, 5.38702947846, 5.66566893424, 5.89786848073, 6.08362811791, 6.13006802721, 6.2693877551, 6.3158276644, 6.54802721088, 6.73378684807, 6.96598639456, 7.10530612245, 7.38394557823, 7.61614512472, 7.8019047619, 8.26630385488, 8.45206349206, 8.68426303855, 8.82358276644, 9.10222222222, 9.28798185941, 9.33442176871, 9.4273015873, 9.5201814059, 9.98458049887, 10.1703401361, 10.4025396825, 10.5418594104, 10.8204988662, 11.0062585034, 11.0526984127, 11.2384580499, 11.4706575964, 11.7028571429, 11.88861678, 12.1208163265, 12.2601360544, 12.5387755102, 12.7245351474, 12.8638548753, 12.9567346939, 13.4211337868, 13.606893424, 13.7926530612, 13.8390929705, 13.9784126984, 14.2570521542, 14.4428117914, 14.6750113379, 14.9072108844, 15.1394104308, 15.325170068, 15.5109297052, 15.5573696145, 15.6966893424, 15.9753287982, 16.1610884354, 16.3004081633, 16.3932879819, 16.6254875283, 16.8576870748, 17.043446712, 17.2292063492, 17.4149659864, 17.6936054422, 17.8793650794, 18.1115646259, 18.761723356, 18.9474829932, 19.1796825397, 19.4118820862, 19.5976417234, 19.8298412698, 20.48, 20.6657596372, 20.8979591837, 21.1301587302, 21.3159183673, 21.5481179138, 21.9660770975, 22.198276644, 22.3840362812, 22.6162358277, 22.8484353741, 23.0341950113, 23.2663945578, 23.6843537415, 23.916553288, 24.1023129252, 24.2416326531, 24.3345124717, 24.5667120181, 24.7524716553, 24.9382312925, 25.4026303855, 25.8205895692, 25.9599092971, 26.0527891156, 26.2385487528, 26.2849886621, 26.4707482993, 26.5636281179, 27.3066666667, 27.5388662132, 27.7710657596, 28.0032653061, 28.1890249433, 28.3747845805, 28.8391836735, 29.2571428571, 29.4893424036, 29.7215419501, 29.9073015873, 30.0930612245, 30.5574603175, 30.9754195011, 31.114739229, 31.3933786848, 31.579138322, 31.6255782313, 31.8113378685, 32.2757369615, 32.4614965986, 32.6936961451, 32.833015873, 33.1116553288, 33.297414966, 33.3438548753, 33.4367346939, 33.5296145125, 33.9940136054, 34.1797732426, 34.3655328798, 34.4119727891, 34.551292517, 34.8299319728, 35.01569161, 35.2478911565, 35.7122902494, 35.8980498866, 36.0838095238, 36.1302494331, 36.5482086168, 36.9661678005, 37.4305668934, 37.6163265306, 37.8020861678, 38.2664852608, 38.452244898, 38.6844444444, 39.1024036281, 39.3346031746, 39.5203628118, 39.9847619048, 40.170521542, 40.4027210884, 41.0528798186, 41.2386394558, 41.7030385488, 41.8887981859, 42.0745578231, 42.1209977324, 42.5389569161, 42.7711564626, 42.9569160998, 43.1891156463, 43.3748752834, 43.6070748299, 43.8392743764, 44.0250340136, 44.2572335601, 44.6751927438, 44.9073922902, 45.0931519274, 45.3253514739, 45.5575510204, 45.9755102041, 46.3934693878, 46.6256689342, 46.8114285714, 47.0436281179, 47.6937868481, 48.1117460317, 48.5297052154, 48.9941043084, 49.4120634921, 49.8300226757, 49.876462585, 50.2944217687, 50.7123809524, 51.5482993197, 51.7804988662, 51.9662585034, 52.1984580499, 52.3842176871, 52.84861678, 53.0343764172, 53.2665759637, 53.4987755102, 53.6845351474, 53.9167346939, 54.0096145125, 54.1024943311, 54.7526530612, 55.1706122449, 55.2170521542, 55.4028117914, 55.5885714286, 55.6350113379, 55.8207709751, 56.0529705215, 56.4709297052, 56.6566893424, 56.7031292517, 56.8424489796, 57.0282086168, 57.1210884354, 57.3068480726, 57.539047619, 58.3749659864, 58.6071655329, 58.8393650794, 59.0251247166, 59.257324263, 59.6752834467, 59.9074829932, 60.0932426304, 60.3254421769, 60.5576417234, 60.7434013605, 60.975600907, 61.3935600907, 61.6257596372, 61.7186394558, 62.0437188209, 62.2759183673, 62.4616780045, 62.693877551, 62.9260770975, 63.5297959184, 63.7155555556, 63.9941950113, 64.1799546485, 64.412154195, 65.2480725624, 65.8982312925, 66.5483900227, 66.8734693878, 66.9663492063, 67.1985487528, 67.6165079365, 68.2666666667, 68.5917460317, 68.6846258503, 69.102585034, 69.3347845805, 69.9849433107, 70.4029024943, 70.5422222222, 70.820861678, 71.0530612245, 71.1459410431, 71.2388208617, 71.4710204082, 71.7032199546, 71.8889795918, 72.1211791383, 72.539138322, 72.7713378685, 72.9570975057, 73.4214965986, 73.6072562358, 73.7465759637, 73.8394557823, 74.257414966, 74.5824943311, 74.6753741497, 75.3255328798, 75.5577324263, 75.97569161, 76.3007709751, 76.3936507937, 76.6258503401, 76.8580498866, 77.0438095238, 77.2760090703, 77.4617687075, 77.693968254, 77.8797278912, 78.019047619, 78.1119274376, 78.3441269841, 78.7620861678, 78.8549659864, 78.9942857143, 79.8302040816, 82.4308390023, 82.8487981859, 83.2667573696, 83.7311564626, 84.5670748299, 84.9850340136, 85.4029931973, 85.820952381, 85.9602721088, 86.0531519274, 86.2389115646, 86.4711111111, 86.6568707483, 86.8890702948, 87.0283900227, 87.1212698413, 87.3070294785, 87.5392290249, 87.6785487528, 87.9571882086, 88.1893877551, 88.2822675737, 88.3751473923, 88.7466666667, 89.0253061224, 89.2575056689, 89.3968253968, 89.6754648526, 89.9076643991, 90.0934240363, 90.3256235828, 90.5578231293, 90.7435827664, 90.9757823129, 91.1151020408, 91.3937414966, 91.5795011338, 91.7188208617, 91.8117006803, 92.0439002268, 92.1832199546, 92.4618594104, 92.6940589569, 92.8333786848, 93.1120181406, 93.2977777778, 93.5299773243, 93.7621768707, 93.9943764172, 94.1801360544, 94.3658956916, 94.4123356009, 94.5516553288, 94.8302947846, 95.0160544218, 95.1553741497, 95.2482539683, 95.6197732426, 95.8984126984, 96.0841723356, 96.1306122449, 96.2699319728, 96.5485714286, 96.7343310658, 96.9665306122, 97.6166893424, 97.8024489796, 98.2668480726, 98.4526077098, 98.5919274376, 98.6848072562, 99.3349659864, 99.5207256236, 99.7529251701, 99.9851247166, 100.170884354, 100.4030839, 100.821043084, 101.05324263, 101.239002268, 101.471201814, 101.703401361, 101.889160998, 102.121360544, 102.446439909, 102.771519274, 102.957278912, 103.096598639, 103.421678005, 103.607437642, 103.793197279, 103.839637188, 104.257596372, 104.675555556, 104.907755102, 105.139954649, 105.325714286, 105.557913832, 105.975873016, 106.3938322, 106.533151927, 106.811791383, 106.858231293, 107.04399093, 107.183310658, 107.69414966, 107.879909297, 108.112108844, 108.251428571, 108.530068027, 108.762267574, 108.948027211, 109.412426304, 109.598185941, 109.830385488, 109.969705215, 110.062585034, 110.248344671, 110.480544218, 110.666303855, 111.130702948, 111.316462585, 111.548662132, 111.687981859, 111.966621315, 112.105941043, 112.384580499, 113.034739229, 113.266938776, 113.406258503, 113.684897959, 113.870657596, 114.102857143, 114.567256236, 114.753015873, 114.93877551, 114.98521542, 115.124535147, 115.403174603, 115.58893424, 115.728253968, 115.821133787, 116.192653061, 116.471292517, 116.657052154, 117.121451247, 117.307210884, 117.539410431, 117.771609977, 118.189569161, 118.375328798, 118.839727891, 119.025487528, 119.257687075, 119.489886621, 120.093605442, 120.325804989, 120.558004535, 120.743764172, 120.975963719, 121.393922902, 121.811882086, 122.044081633, 122.22984127, 122.276281179, 122.462040816, 122.694240363, 123.112199546, 123.576598639, 123.994557823, 124.412517007, 124.83047619, 125.294875283, 125.712834467, 126.130793651, 126.17723356, 126.966712018, 127.198911565, 127.384671202, 127.616870748, 127.802630385, 128.267029478, 128.452789116, 128.684988662, 128.917188209, 129.102947846, 129.335147392, 129.567346939, 129.985306122, 130.17106576, 130.310385488, 130.635464853, 130.82122449, 131.053424036, 131.239183673, 131.47138322, 132.12154195, 132.307301587, 132.446621315, 132.585941043, 132.77170068, 132.957460317, 133.839818594, 134.025578231, 134.257777778, 134.675736961, 135.140136054, 135.325895692, 135.558095238, 135.743854875, 135.976054422, 136.208253968, 136.301133787, 136.394013605, 136.811972789, 137.044172336, 137.137052154, 137.462131519, 137.694331066, 137.880090703, 137.926530612, 138.112290249, 138.344489796, 138.948208617, 139.133968254, 139.180408163, 139.41260771, 139.598367347, 139.830566893, 140.666485261, 141.130884354, 141.316643991, 141.548843537, 141.966802721, 142.199002268, 142.384761905, 142.616961451, 142.849160998, 143.034920635, 143.267120181, 143.685079365, 144.01015873, 144.753197279, 145.403356009, 145.821315193, 146.053514739, 146.239274376, 146.471473923, 146.703673469, 147.121632653, 147.446712018, 147.539591837, 148.189750567, 148.375510204, 148.839909297, 149.257868481, 149.908027211, 150.000907029, 150.093786848, 150.558185941, 150.976145125, 151.394104308, 151.626303855, 151.812063492, 152.276462585, 152.694421769, 152.880181406, 153.112380952, 153.437460317, 153.530340136, 153.762539683, 154.180498866, 154.412698413, 156.130975057, 157.849251701]
#onset_times = [0.0, 0.227845804989, 0.499954648526, 0.681360544218, 0.953469387755, 1.13487528345, 1.40698412698, 1.58839002268, 1.76979591837, 1.95120181406, 2.2233106576, 2.40471655329, 2.67682539683, 2.85823129252, 3.13034013605, 3.31174603175, 3.49315192744, 3.67455782313, 3.94666666667, 4.12807256236, 4.4001814059, 4.58158730159, 4.76299319728, 5.03510204082, 5.21650793651, 5.3979138322, 5.67002267574, 5.85142857143, 6.12353741497, 6.30494331066, 6.48634920635, 6.75845804989, 6.93986394558, 7.12126984127, 7.39337868481, 7.5747845805, 7.75619047619, 8.20970521542, 8.66321995465, 8.84462585034, 9.11673469388, 9.29814058957, 9.93306122449, 10.3865759637, 10.5679818594, 10.8400907029, 11.0214965986, 11.2029024943, 11.6564172336, 11.8378231293, 12.1099319728, 12.2913378685, 12.4727437642, 12.7448526077, 13.3797732426, 14.1960997732, 14.4682086168, 14.6496145125, 15.1031292517, 15.2845351474, 15.4659410431, 15.9194557823, 16.3729705215, 16.8264852608, 17.0078911565, 17.1892970522, 17.3707029478, 17.6428117914, 17.8242176871, 18.0963265306, 18.5498412698, 18.7312471655, 18.9126530612, 19.3661678005, 19.5475736961, 19.8196825397, 20.6360090703, 20.817414966, 21.0895238095, 21.2709297052, 22.3593650794, 22.5407709751, 22.8128798186, 22.9942857143, 23.2663945578, 23.9013151927, 24.0827210884, 24.2641269841, 24.5362358277, 24.7176417234, 24.899047619, 25.3525623583, 25.8060770975, 25.9874829932, 26.2595918367, 26.4409977324, 27.9829478458, 28.1643537415, 28.3457596372, 28.7992743764, 29.4341950113, 29.8877097506, 30.5226303855, 31.3389569161, 31.6110657596, 31.7924716553, 32.2459863946, 32.4273922902, 32.6087981859, 33.0623129252, 33.3344217687, 33.5158276644, 33.9693424036, 34.1507482993, 34.332154195, 34.7856689342, 34.9670748299, 35.1484807256, 35.6926984127, 35.8741043084, 36.0555102041, 36.2369160998, 36.5090249433, 36.690430839, 36.9625396825, 37.5974603175, 37.7788662132, 38.2323809524, 38.4137868481, 39.5022222222, 39.6836281179, 39.9557369615, 40.1371428571, 40.4092517007, 41.2255782313, 41.406984127, 41.6790929705, 41.8604988662, 42.0419047619, 42.4954195011, 42.9489342404, 43.4024489796, 43.5838548753, 43.765260771, 44.0373696145, 44.2187755102, 44.4001814059, 44.6722902494, 45.1258049887, 45.3072108844, 45.48861678, 45.9421315193, 46.3956462585, 46.7584580499, 47.2119727891, 47.6654875283, 48.1190022676, 48.9353287982, 49.3888435374, 49.8423582766, 50.2958730159, 51.4750113379, 51.7471201814, 51.9285260771, 52.3820408163, 52.8355555556, 53.0169614512, 53.1983673469, 53.4704761905, 53.6518820862, 54.1053968254, 55.1938321995, 55.3752380952, 55.5566439909, 55.8287528345, 56.0101587302, 56.2822675737, 56.6450793651, 56.8264852608, 57.0078911565, 57.28, 57.5521088435, 58.3684353741, 58.5498412698, 58.8219501134, 59.0033560091, 59.638276644, 59.9103854875, 60.0917913832, 60.2731972789, 60.5453061224, 60.7267120181, 61.7244444444, 61.996553288, 62.2686621315, 62.4500680272, 62.6314739229, 62.9035827664, 63.5385034014, 63.7199092971, 63.9920181406, 64.1734240363, 66.078185941, 66.5317006803, 69.07138322, 69.9784126984, 70.5226303855, 70.794739229, 70.9761451247, 71.2482539683, 74.2414512472, 74.6949659864, 75.6926984127, 76.1462131519, 76.7811337868, 77.2346485261, 77.4160544218, 77.6881632653, 77.869569161, 82.4047165533, 83.6745578231, 85.3979138322, 85.7607256236, 85.9421315193, 86.2142403628, 86.3956462585, 86.667755102, 87.1212698413, 87.302675737, 87.4840816327, 87.6654875283, 87.9375963719, 88.1190022676, 88.3911111111, 88.7539229025, 89.026031746, 89.2074376417, 89.3888435374, 89.660952381, 89.8423582766, 90.0237641723, 90.4772789116, 90.9307936508, 91.1121995465, 91.38430839, 91.5657142857, 91.8378231293, 92.6541496599, 92.8355555556, 93.1076643991, 93.2890702948, 93.4704761905, 93.9239909297, 94.3775056689, 94.5589115646, 94.8310204082, 95.0124263039, 95.5566439909, 96.100861678, 96.2822675737, 96.7357823129, 96.9171882086, 97.3707029478, 97.5521088435, 97.8242176871, 98.0056235828, 98.1870294785, 98.459138322, 99.0033560091, 99.9103854875, 100.182494331, 100.363900227, 100.817414966, 100.998820862, 101.180226757, 101.633741497, 102.087256236, 102.450068027, 102.722176871, 102.903582766, 103.357097506, 103.810612245, 104.264126984, 104.626938776, 104.899047619, 105.080453515, 105.26185941, 105.533968254, 106.350294785, 106.53170068, 106.803809524, 106.98521542, 107.166621315, 107.892244898, 108.073650794, 108.255056689, 108.527165533, 108.708571429, 108.980680272, 109.615600907, 109.797006803, 109.978412698, 110.250521542, 110.431927438, 110.613333333, 111.066848073, 111.520362812, 111.701768707, 111.973877551, 113.243718821, 113.425124717, 113.878639456, 114.060045351, 114.513560091, 114.96707483, 115.601995465, 117.05324263, 117.325351474, 117.50675737, 117.960272109, 118.141678005, 118.3230839, 118.776598639, 119.048707483, 119.230113379, 119.59292517, 120.499954649, 120.953469388, 121.769795918, 122.223310658, 122.676825397, 123.039637188, 123.946666667, 124.400181406, 124.853696145, 125.670022676, 126.123537415, 126.939863946, 127.121269841, 127.393378685, 127.57478458, 128.209705215, 128.481814059, 128.663219955, 128.84462585, 129.116734694, 129.29814059, 129.933061224, 130.295873016, 130.567981859, 130.840090703, 131.021496599, 131.202902494, 131.475011338, 132.109931973, 132.291337868, 132.563446712, 132.744852608, 132.926258503, 133.379773243, 133.833287982, 134.014693878, 134.649614512, 135.103129252, 135.284535147, 135.738049887, 135.919455782, 136.191564626, 136.826485261, 137.461405896, 137.642811791, 137.914920635, 138.096326531, 138.912653061, 139.094058957, 139.81968254, 140.63600907, 141.08952381, 142.812879819, 142.994285714, 143.266394558, 143.629206349, 144.264126984, 144.717641723, 145.352562358, 145.806077098, 145.987482993, 146.259591837, 146.440997732, 147.075918367, 147.529433107, 148.345759637, 148.799274376, 149.252789116, 149.434195011, 150.976145125, 152.245986395, 152.880907029, 153.062312925, 153.515827664, 154.422857143, 155.239183673, 156.962539683]
#onset_times = [0.0, 0.139319727891, 0.78947845805, 0.975238095238, 1.43963718821, 1.6253968254, 1.81115646259, 2.27555555556, 2.64707482993, 2.92571428571, 3.1114739229, 3.66875283447, 4.41179138322, 4.87619047619, 5.06195011338, 5.24770975057, 5.71210884354, 5.89786848073, 6.08362811791, 6.54802721088, 6.73378684807, 7.56970521542, 7.8483446712, 8.12698412698, 8.31274376417, 8.77714285714, 9.14866213152, 9.33442176871, 9.5201814059, 9.98458049887, 11.0062585034, 11.1920181406, 11.7492970522, 12.1208163265, 12.2136961451, 12.4923356009, 12.7709750567, 12.9567346939, 13.8855328798, 14.2570521542, 14.7214512472, 15.5573696145, 16.3932879819, 16.8576870748, 17.6936054422, 17.8793650794, 18.1580045351, 18.9939229025, 19.5512018141, 19.8298412698, 20.7586394558, 21.1301587302, 21.3159183673, 21.5945578231, 22.4304761905, 22.8019954649, 22.987755102, 23.2663945578, 24.5667120181, 24.7524716553, 24.9382312925, 25.8670294785, 26.2385487528, 26.42430839, 26.7029478458, 27.6317460317, 28.1890249433, 28.8391836735, 29.860861678, 30.5110204082, 30.9754195011, 31.6255782313, 31.9042176871, 32.2757369615, 33.1116553288, 33.297414966, 34.4119727891, 35.1550113379, 35.3407709751, 35.7122902494, 35.8980498866, 36.3624489796, 36.5482086168, 37.8485260771, 38.6844444444, 39.1488435374, 39.6132426304, 39.9847619048, 40.170521542, 41.2850793651, 42.1209977324, 43.0497959184, 43.6070748299, 43.8857142857, 44.7216326531, 45.186031746, 47.3222675737, 48.158185941, 49.8300226757, 50.0157823129, 50.4801814059, 51.5018594104, 51.7804988662, 51.9662585034, 52.1520181406, 52.4306575964, 53.9167346939, 54.566893424, 54.7526530612, 54.8455328798, 55.4028117914, 55.5885714286, 56.2387301587, 56.7960090703, 56.9817687075, 57.3532879819, 57.539047619, 58.8393650794, 59.0251247166, 59.6752834467, 59.8610430839, 60.3254421769, 60.5112018141, 60.975600907, 61.7186394558, 61.9972789116, 62.2759183673, 62.4616780045, 62.6474376417, 63.6691156463, 63.8548752834, 64.412154195, 65.340952381, 65.7124716553, 66.5483900227, 67.848707483, 70.820861678, 71.285260771, 71.5639002268, 71.7496598639, 72.1211791383, 73.4214965986, 73.8858956916, 74.257414966, 75.5577324263, 76.8580498866, 77.4153287982, 77.693968254, 78.9942857143, 82.4308390023, 82.6165986395, 82.8023582766, 83.2667573696, 84.5670748299, 85.8673922902, 86.4246712018, 86.7033106576, 87.1677097506, 87.6321088435, 88.0036281179, 88.1893877551, 88.3751473923, 89.3968253968, 89.6754648526, 89.8612244898, 90.1398639456, 90.9757823129, 91.3473015873, 91.6259410431, 91.8117006803, 92.2760997732, 93.1120181406, 93.2977777778, 93.5764172336, 94.4123356009, 95.2482539683, 95.8984126984, 96.1770521542, 96.5485714286, 96.7343310658, 97.0129705215, 97.8488888889, 98.2204081633, 98.4061678005, 98.6848072562, 99.3349659864, 99.9851247166, 100.170884354, 101.285442177, 101.842721088, 102.121360544, 103.05015873, 103.421678005, 103.607437642, 104.071836735, 104.257596372, 104.721995465, 105.279274376, 105.557913832, 106.486712018, 106.672471655, 106.858231293, 107.04399093, 107.322630385, 107.69414966, 108.530068027, 108.715827664, 108.99446712, 109.830385488, 110.480544218, 110.759183673, 111.130702948, 111.502222222, 111.966621315, 113.266938776, 113.359818594, 113.917097506, 114.102857143, 114.567256236, 115.031655329, 115.403174603, 115.58893424, 115.867573696, 116.703492063, 117.539410431, 118.468208617, 118.839727891, 119.025487528, 119.304126984, 119.768526077, 120.140045351, 120.604444444, 123.576598639, 125.062675737, 125.712834467, 125.898594104, 127.198911565, 127.384671202, 127.570430839, 127.849070295, 128.499229025, 128.777868481, 129.149387755, 129.335147392, 129.985306122, 130.17106576, 130.635464853, 130.82122449, 131.006984127, 132.12154195, 132.400181406, 132.585941043, 132.77170068, 132.957460317, 133.42185941, 134.072018141, 134.257777778, 134.443537415, 135.093696145, 135.743854875, 135.929614512, 136.858412698, 137.137052154, 137.41569161, 137.694331066, 137.880090703, 138.06585034, 139.087528345, 139.273287982, 139.459047619, 139.830566893, 142.431201814, 143.267120181, 145.403356009, 146.703673469, 147.539591837, 148.468390023, 148.839909297, 150.140226757, 150.976145125, 151.904943311, 152.276462585, 154.412698413]
onset_times = [0.0, 0.673378684807, 1.32353741497, 1.74149659864, 2.02013605442, 3.04181405896, 3.25079365079, 4.10993197279, 4.24925170068, 4.94585034014, 5.80498866213, 5.92108843537, 6.64090702948, 6.82666666667, 7.17496598639, 8.03410430839, 8.49850340136, 8.59138321995, 8.87002267574, 9.4737414966, 9.61306122449, 9.79882086168, 9.89170068027, 10.1006802721, 10.704399093, 11.0759183673, 11.493877551, 11.7957369615, 11.9350566893, 12.353015873, 12.6548752834, 12.7709750567, 12.8870748299, 13.5372335601, 13.6997732426, 13.8623129252, 14.0945124717, 14.3499319728, 14.5124716553, 14.7214512472, 14.930430839, 15.1626303855, 15.3716099773, 15.5573696145, 15.789569161, 16.0217687075, 16.2075283447, 16.3236281179, 16.4397278912, 16.6254875283, 16.9505668934, 17.0898866213, 17.2756462585, 17.4846258503, 17.7400453515, 17.7864852608, 17.9258049887, 18.1347845805, 18.3437641723, 18.4830839002, 18.5991836735, 18.6456235828, 19.0171428571, 19.2029024943, 19.4583219955, 19.5047619048, 19.6440816327, 19.7601814059, 19.8762811791, 19.9691609977, 20.085260771, 20.2013605442, 20.4103401361, 20.5264399093, 20.7121995465, 20.9211791383, 21.1533786848, 21.3623582766, 21.5713378685, 21.7803174603, 21.9196371882, 22.0357369615, 22.0821768707, 22.2214965986, 22.4072562358, 22.6394557823, 22.7323356009, 22.8716553288, 23.0806349206, 23.1735147392, 23.3128344671, 23.3824943311, 23.4985941043, 23.6379138322, 23.8004535147, 23.9397732426, 24.1487528345, 24.3577324263, 24.5899319728, 24.77569161, 24.9614512472, 25.0078911565, 25.2168707483, 25.3329705215, 25.5187301587, 25.8438095238, 26.0760090703, 26.3314285714, 26.3778684807, 26.493968254, 26.6100680272, 26.7261678005, 26.9351473923, 27.0512471655, 27.1673469388, 27.3763265306, 27.5853061224, 27.7246258503, 27.9103854875, 28.0497052154, 28.2354648526, 28.4212244898, 28.7695238095, 28.8159637188, 29.1410430839, 29.3035827664, 29.6286621315, 29.7912018141, 29.930521542, 30.0234013605, 30.1627210884, 30.5110204082, 30.8825396825, 31.0218594104, 31.4862585034, 31.6487981859, 31.8345578231, 32.2525170068, 32.5079365079, 32.7169160998, 32.9723356009, 33.1813151927, 33.3670748299, 33.4599546485, 33.5760544218, 34.0404535147, 34.086893424, 34.2262131519, 34.4351927438, 34.620952381, 34.8995918367, 34.946031746, 35.0853514739, 35.2711111111, 35.4800907029, 35.6194104308, 35.7587301587, 35.805170068, 35.9444897959, 36.1534693878, 36.4088888889, 36.5946485261, 36.8732879819, 37.0126077098, 37.3144671202, 37.4537868481, 37.5466666667, 37.6627664399, 37.8485260771, 37.987845805, 38.2897052154, 38.4986848073, 38.7076643991, 38.9166439909, 39.1952834467, 39.3810430839, 39.5668027211, 39.8686621315, 40.0079818594, 40.2169614512, 40.3330612245, 40.4491609977, 40.5188208617, 40.6349206349, 40.7742403628, 40.8903401361, 40.96, 41.0760997732, 41.2850793651, 41.4708390023, 41.5172789116, 41.7726984127, 41.9352380952, 42.1209977324, 42.3299773243, 42.7943764172, 43.073015873, 43.2587755102, 43.467755102, 43.5141950113, 43.6535147392, 43.9089342404, 44.1643537415, 44.326893424, 44.7680725624, 44.9770521542, 45.0467120181, 45.2092517007, 45.25569161, 45.3717913832, 45.6272108844, 46.0683900227, 46.4631292517, 46.90430839, 46.9507482993, 47.0668480726, 47.3222675737, 47.368707483, 47.5080272109, 47.7866666667, 48.2046258503, 48.2742857143, 48.4136054422, 48.6458049887, 48.8315646259, 49.0637641723, 49.1334240363, 49.3424036281, 49.5049433107, 49.946122449, 50.3873015873, 50.805260771, 51.3160997732, 52.1055782313, 52.7325170068, 52.8718367347, 53.0575963719, 53.1736961451, 53.313015873, 53.8238548753, 54.2882539683, 54.566893424, 54.6829931973, 54.8687528345, 54.9848526077, 55.1241723356, 55.3099319728, 55.49569161, 55.6350113379, 55.7511111111, 55.8439909297, 56.1458503401, 56.6102494331, 56.7031292517, 56.7727891156, 56.9353287982, 57.0978684807, 57.1907482993, 57.4693877551, 57.6551473923, 57.7944671202, 57.9802267574, 58.3053061224, 58.4446258503, 58.8858049887, 59.0019047619, 59.1876643991, 59.4430839002, 59.5824036281, 59.721723356, 59.9074829932, 60.1396825397, 60.8827210884, 60.975600907, 61.1381405896, 61.44, 61.5560997732, 61.7418594104, 61.8579591837, 61.904399093, 62.1598185941, 62.3455782313, 62.4848979592, 62.6009977324, 62.7170975057, 62.7867573696, 62.9957369615, 63.4369160998, 63.5762358277, 63.8548752834, 63.947755102, 64.0638548753, 64.2263945578, 64.3192743764, 64.4353741497, 64.806893424, 65.2945124717, 65.9214512472, 66.0375510204, 66.130430839, 66.3626303855, 66.5716099773, 66.8038095238, 66.8966893424, 67.0127891156, 67.3146485261, 67.453968254, 67.6397278912, 67.7558276644, 67.8719274376, 68.0576870748, 68.2898866213, 68.6149659864, 68.7310657596, 68.7775056689, 68.9632653061, 69.172244898, 69.3812244898, 69.5437641723, 69.6830839002, 69.8224036281, 69.8688435374, 70.1010430839, 70.3100226757, 70.426122449, 70.7512018141, 70.8673015873, 71.0530612245, 71.1923809524, 71.285260771, 71.3781405896, 71.5174603175, 71.7264399093, 71.8193197279, 72.0282993197, 72.144399093, 72.4230385488, 72.5855782313, 72.7945578231, 73.003537415, 73.2357369615, 73.4447165533, 73.7697959184, 73.862675737, 73.9323356009, 74.0948752834, 74.1645351474, 74.3038548753, 74.3735147392, 74.6057142857, 74.721814059, 74.8146938776, 74.9075736961, 75.1629931973, 75.2790929705, 75.4648526077, 75.580952381, 75.8131519274, 75.8828117914, 76.0453514739, 76.2311111111, 76.3239909297, 76.4168707483, 76.5561904762, 76.6722902494, 76.7419501134, 76.9509297052, 77.1831292517, 77.2992290249, 77.5314285714, 77.6010884354, 77.7404081633, 77.9261678005, 78.0422675737, 78.2512471655, 78.3673469388, 78.5763265306, 78.6924263039, 78.9014058957, 78.9942857143, 79.5515646259, 81.4788208617, 81.7110204082, 82.0360997732, 82.1754195011, 82.6398185941, 82.8255782313, 83.0113378685, 83.173877551, 83.3131972789, 83.6150566893, 83.8008163265, 84.033015873, 84.6135147392, 85.2404535147, 85.5423129252, 85.6816326531, 86.1228117914, 86.3782312925, 86.5175510204, 86.8194104308, 86.9355102041, 87.7714285714, 88.0732879819, 88.2126077098, 88.328707483, 88.5144671202, 88.6305668934, 88.9788662132, 89.6754648526, 89.7683446712, 89.9308843537, 90.1398639456, 90.3488435374, 90.5578231293, 90.6042630385, 90.7900226757, 90.9990022676, 91.2079818594, 91.4634013605, 91.6491609977, 91.765260771, 91.8581405896, 92.0439002268, 92.2760997732, 92.3921995465, 92.5082993197, 92.7172789116, 92.8798185941, 92.9262585034, 93.1816780045, 93.3674376417, 93.5531972789, 93.7853968254, 94.0175963719, 94.0640362812, 94.2265759637, 94.4355555556, 94.4819954649, 94.6445351474, 94.8767346939, 95.0624943311, 95.1785941043, 95.2946938776, 95.5036734694, 95.6894331066, 95.7358730159, 95.8287528345, 95.9448526077, 96.1306122449, 96.3395918367, 96.45569161, 96.5950113379, 96.7807709751, 96.9897505669, 97.2219501134, 97.4541496599, 97.5005895692, 97.6399092971, 97.8488888889, 98.0578684807, 98.1275283447, 98.2900680272, 98.499047619, 98.6151473923, 98.7312471655, 98.9170068027, 99.0795464853, 99.1724263039, 99.2653061224, 99.358185941, 99.5671655329, 99.7761451247, 100.078004535, 100.217324263, 100.4030839, 100.542403628, 100.635283447, 100.937142857, 101.09968254, 101.285442177, 101.494421769, 101.74984127, 101.796281179, 101.912380952, 102.05170068, 102.144580499, 102.237460317, 102.353560091, 102.562539683, 102.70185941, 102.817959184, 103.003718821, 103.143038549, 103.328798186, 103.468117914, 103.514557823, 103.677097506, 103.862857143, 104.211156463, 104.559455782, 104.605895692, 104.74521542, 104.977414966, 105.209614512, 105.372154195, 105.465034014, 105.581133787, 105.952653061, 106.277732426, 106.463492063, 106.927891156, 106.974331066, 107.067210884, 107.276190476, 107.647709751, 107.763809524, 107.926349206, 108.158548753, 108.204988662, 108.437188209, 108.622947846, 108.878367347, 109.017687075, 109.528526077, 109.64462585, 109.853605442, 110.062585034, 110.34122449, 110.387664399, 110.68952381, 111.037823129, 111.177142857, 111.362902494, 111.571882086, 111.850521542, 112.013061224, 112.198820862, 112.314920635, 112.431020408, 112.848979592, 112.98829932, 113.081179138, 113.29015873, 113.429478458, 113.568798186, 113.708117914, 113.94031746, 114.033197279, 114.126077098, 114.358276644, 114.497596372, 114.613696145, 114.799455782, 114.869115646, 114.98521542, 115.426394558, 115.472834467, 115.63537415, 115.751473923, 115.867573696, 116.076553288, 116.215873016, 116.401632653, 116.494512472, 116.703492063, 116.912471655, 117.144671202, 117.23755102, 117.353650794, 117.539410431, 117.771609977, 118.119909297, 118.23600907, 118.468208617, 118.514648526, 118.653968254, 118.909387755, 118.955827664, 119.095147392, 119.350566893, 119.745306122, 120.209705215, 120.372244898, 120.650884354, 120.790204082, 121.045623583, 121.092063492, 121.23138322, 121.927981859, 122.113741497, 122.345941043, 122.508480726, 122.787120181, 122.949659864, 123.18185941, 123.576598639, 123.646258503, 123.715918367, 123.87845805, 124.087437642, 124.249977324, 124.505396825, 124.760816327, 124.946575964, 125.387755102, 125.596734694, 125.805714286, 126.223673469, 126.571972789, 126.897052154, 127.059591837, 127.338231293, 127.547210884, 127.709750567, 128.17414966, 128.290249433, 128.47600907, 128.708208617, 128.754648526, 129.242267574, 129.451247166, 129.892426304, 130.008526077, 130.12462585, 130.217505669, 130.310385488, 130.426485261, 130.496145125, 130.542585034, 130.728344671, 130.914104308, 131.053424036, 131.16952381, 131.285623583, 131.378503401, 131.587482993, 132.028662132, 132.144761905, 132.353741497, 132.632380952, 132.887800454, 133.073560091, 133.305759637, 133.445079365, 133.537959184, 133.677278912, 133.723718821, 133.886258503, 134.42031746, 134.606077098, 134.838276644, 135.024036281, 135.163356009, 135.349115646, 135.581315193, 136.11537415, 136.185034014, 136.324353741, 136.579773243, 136.858412698, 136.974512472, 137.160272109, 137.299591837, 137.346031746, 137.578231293, 137.787210884, 137.926530612, 138.019410431, 138.135510204, 138.251609977, 138.41414966, 138.855328798, 138.901768707, 138.994648526, 139.296507937, 139.482267574, 139.644807256, 139.760907029, 139.853786848, 140.155646259, 140.271746032, 140.71292517, 140.759365079, 141.01478458, 141.339863946, 141.455963719, 141.572063492, 141.781043084, 141.990022676, 142.106122449, 142.338321995, 142.431201814, 142.895600907, 143.081360544, 143.174240363, 143.313560091, 143.476099773, 143.545759637, 143.70829932, 143.940498866, 144.033378685, 144.172698413, 144.219138322, 144.404897959, 144.567437642, 144.66031746, 144.799637188, 144.985396825, 145.240816327, 145.542675737, 145.751655329, 145.867755102, 146.076734694, 146.169614512, 146.332154195, 146.378594104, 146.517913832, 146.610793651, 146.703673469, 146.796553288, 146.935873016, 147.028752834, 147.168072562, 147.237732426, 147.469931973, 147.586031746, 148.027210884, 148.212970522, 148.30585034, 148.421950113, 148.839909297, 148.979229025, 149.072108844, 149.188208617, 149.281088435, 149.490068027, 149.6061678, 149.745487528, 150.024126984, 150.140226757, 150.395646259, 150.581405896, 150.697505669, 150.883265306, 151.022585034, 151.25478458, 151.510204082, 151.64952381, 151.835283447, 151.974603175, 152.067482993, 152.369342404, 152.578321995, 152.717641723, 152.926621315, 153.042721088, 153.182040816, 153.367800454, 153.460680272, 153.669659864, 153.808979592, 153.90185941, 154.017959184, 154.087619048, 154.226938776, 154.319818594, 154.412698413, 154.575238095, 154.760997732, 154.969977324]
onset_times = [0.0, 0.185759637188, 0.255419501134, 0.534058956916, 0.743038548753, 0.95201814059, 1.18421768707, 1.39319727891, 1.60217687075, 1.81115646259, 1.97369614512, 2.25233560091, 2.46131519274, 2.67029478458, 2.87927437642, 3.1114739229, 3.32045351474, 3.52943310658, 3.69197278912, 3.9706122449, 4.15637188209, 4.38857142857, 4.59755102041, 4.82975056689, 5.03873015873, 5.24770975057, 5.41024943311, 5.61922902494, 5.68888888889, 5.87464852608, 6.10684807256, 6.3158276644, 6.54802721088, 6.73378684807, 6.91954648526, 7.10530612245, 7.38394557823, 7.59292517007, 7.8019047619, 8.24308390023, 8.45206349206, 8.6610430839, 8.82358276644, 9.10222222222, 9.31120181406, 9.35764172336, 9.45052154195, 9.58984126984, 9.96136054422, 10.1239002268, 10.3793197279, 10.5418594104, 10.6115192744, 10.8204988662, 11.029478458, 11.2152380952, 11.6796371882, 11.88861678, 12.0975963719, 12.2601360544, 12.3297959184, 12.5387755102, 12.747755102, 12.8870748299, 13.0263945578, 13.3979138322, 13.4443537415, 13.8158730159, 13.9784126984, 14.2338321995, 14.466031746, 14.6517913832, 15.0465306122, 15.1161904762, 15.4644897959, 15.5341496599, 15.6966893424, 15.9521088435, 16.1610884354, 16.3236281179, 16.4397278912, 16.9737868481, 17.1827664399, 17.2292063492, 17.4149659864, 17.6703854875, 17.8793650794, 18.0883446712, 18.4830839002, 18.9474829932, 19.1100226757, 19.1796825397, 19.3886621315, 19.5976417234, 19.7369614512, 19.8762811791, 20.2942403628, 20.4103401361, 20.6657596372, 21.1069387755, 21.3159183673, 21.5248979592, 21.9660770975, 22.3840362812, 22.8252154195, 23.0341950113, 23.1735147392, 23.2896145125, 23.8236734694, 24.1023129252, 24.2648526077, 24.5202721088, 24.7292517007, 24.9382312925, 25.3329705215, 25.4026303855, 25.7509297052, 25.8205895692, 25.9831292517, 26.2385487528, 26.4475283447, 26.6100680272, 26.7261678005, 27.2602267574, 27.5156462585, 27.678185941, 27.9568253968, 28.1658049887, 28.3747845805, 29.1874829932, 29.2571428571, 29.6286621315, 29.6751020408, 29.8840816327, 30.0234013605, 30.1627210884, 30.5342403628, 30.9521995465, 31.3933786848, 31.6023582766, 31.7416780045, 31.8113378685, 32.2525170068, 32.4614965986, 32.6704761905, 33.1116553288, 33.3206349206, 33.3670748299, 33.4599546485, 34.1101133787, 34.3190929705, 34.3887528345, 34.551292517, 34.8067120181, 35.01569161, 35.1782312925, 35.2478911565, 35.6890702948, 35.8283900227, 35.8980498866, 36.1070294785, 36.5482086168, 36.8965079365, 37.0126077098, 37.5466666667, 37.7556462585, 37.8253061224, 37.987845805, 38.2432653061, 38.452244898, 38.6612244898, 39.1024036281, 39.5203628118, 39.9615419501, 40.170521542, 40.3098412698, 40.4491609977, 40.9832199546, 41.2386394558, 41.6798185941, 41.8887981859, 42.0977777778, 42.5389569161, 42.7479365079, 42.9569160998, 43.1891156463, 43.3748752834, 43.8160544218, 44.2572335601, 44.396553288, 44.6751927438, 45.0931519274, 45.5343310658, 45.9058503401, 45.9755102041, 46.3934693878, 46.8114285714, 47.2526077098, 47.833106576, 48.1349659864, 48.5297052154, 48.9708843537, 49.3888435374, 49.8300226757, 50.2712018141, 50.6891609977, 51.5250793651, 51.7572789116, 52.3842176871, 52.8253968254, 53.0343764172, 53.1969160998, 53.4058956916, 53.4755555556, 53.6845351474, 53.8935147392, 53.9399546485, 54.4740136054, 54.5436734694, 54.7990929705, 54.8687528345, 55.1241723356, 55.1706122449, 55.3331519274, 55.4028117914, 55.6117913832, 55.8207709751, 56.0529705215, 56.6102494331, 56.6799092971, 56.8424489796, 57.0978684807, 57.3300680272, 57.3765079365, 57.4693877551, 57.5854875283, 57.9105668934, 58.3285260771, 58.6071655329, 58.8393650794, 59.257324263, 59.6752834467, 59.8378231293, 59.9074829932, 60.0468027211, 60.2557823129, 60.3254421769, 60.4879818594, 60.5344217687, 60.7666213152, 60.9059410431, 60.975600907, 61.0220408163, 61.3239002268, 61.3935600907, 61.6489795918, 61.7650793651, 61.9740589569, 62.0437188209, 62.2526984127, 62.4616780045, 62.6706575964, 62.9028571429, 63.6923356009, 63.8084353741, 64.1799546485, 64.2263945578, 64.3424943311, 64.8301133787, 66.2697505669, 66.5483900227, 66.6877097506, 66.8966893424, 67.3378684807, 67.6165079365, 67.7558276644, 67.8719274376, 68.1970068027, 68.5220861678, 68.6149659864, 69.2651247166, 69.4741043084, 69.5902040816, 69.9849433107, 70.3332426304, 70.6118820862, 70.7744217687, 70.820861678, 71.0298412698, 71.0762811791, 71.1691609977, 71.3084807256, 71.9354195011, 72.0515192744, 73.398276644, 73.7465759637, 74.5128344671, 74.6289342404, 74.721814059, 75.046893424, 75.3719727891, 75.4648526077, 75.6970521542, 76.3239909297, 76.834829932, 77.4153287982, 77.62430839, 77.693968254, 77.9029478458, 78.0422675737, 78.1583673469, 78.2744671202, 78.483446712, 78.6924263039, 78.8085260771, 78.9014058957, 82.384399093, 82.8255782313, 83.2899773243, 83.6847165533, 84.102675737, 84.5438548753, 85.4029931973, 85.751292517, 85.7977324263, 85.9602721088, 86.2389115646, 86.4478911565, 86.6568707483, 87.0283900227, 87.2605895692, 87.469569161, 87.5160090703, 87.6785487528, 87.9571882086, 88.1661678005, 88.3054875283, 88.4448072562, 88.5609070295, 88.7466666667, 88.9788662132, 89.187845805, 89.2342857143, 89.3968253968, 89.6754648526, 89.8844444444, 90.0934240363, 90.5346031746, 90.9525623583, 91.1151020408, 91.370521542, 91.6027210884, 91.7420408163, 91.8813605442, 92.1832199546, 92.6708390023, 92.8333786848, 93.0887981859, 93.2977777778, 93.5067573696, 93.6925170068, 93.9014965986, 93.9711564626, 94.1801360544, 94.3891156463, 94.5516553288, 94.8070748299, 95.0160544218, 95.1785941043, 95.2946938776, 95.6197732426, 95.8287528345, 96.0377324263, 96.1073922902, 96.2699319728, 96.5253514739, 96.7343310658, 96.9433106576, 97.3380498866, 97.5470294785, 97.7560090703, 97.8024489796, 97.9882086168, 98.2436281179, 98.4526077098, 98.5919274376, 98.7312471655, 99.2653061224, 99.5207256236, 99.9619047619, 100.170884354, 100.379863946, 100.75138322, 100.821043084, 101.239002268, 101.471201814, 101.680181406, 101.889160998, 102.028480726, 102.167800454, 102.469659864, 102.887619048, 103.39845805, 103.607437642, 103.816417234, 104.257596372, 104.675555556, 105.116734694, 105.325714286, 105.465034014, 105.581133787, 105.975873016, 106.324172336, 106.3938322, 106.556371882, 106.811791383, 107.020770975, 107.160090703, 107.252970522, 107.69414966, 107.833469388, 108.04244898, 108.088888889, 108.530068027, 108.739047619, 108.878367347, 109.017687075, 109.551746032, 109.807165533, 110.248344671, 110.457324263, 110.596643991, 110.666303855, 111.107482993, 111.316462585, 111.525442177, 111.711201814, 111.966621315, 112.314920635, 112.756099773, 113.243718821, 113.684897959, 113.870657596, 114.079637188, 114.544036281, 114.961995465, 115.403174603, 115.58893424, 115.751473923, 115.867573696, 116.401632653, 116.610612245, 116.680272109, 117.098231293, 117.307210884, 117.516190476, 118.119909297, 118.375328798, 118.816507937, 119.23446712, 119.605986395, 120.116825397, 120.53478458, 120.952743764, 121.393922902, 121.811882086, 122.253061224, 122.671020408, 123.042539683, 123.112199546, 123.553378685, 123.971337868, 124.389297052, 124.83047619, 125.271655329, 125.689614512, 126.130793651, 126.966712018, 127.17569161, 127.407891156, 127.82585034, 128.243809524, 128.406349206, 128.47600907, 128.893968254, 129.056507937, 129.1261678, 129.335147392, 129.47446712, 129.544126984, 129.962086168, 130.287165533, 130.333605442, 130.612244898, 130.82122449, 131.053424036, 131.239183673, 132.260861678, 132.376961451, 132.748480726, 132.887800454, 133.398639456, 133.746938776, 134.025578231, 134.257777778, 134.675736961, 135.1169161, 135.325895692, 135.743854875, 135.976054422, 136.185034014, 136.394013605, 136.835192744, 137.090612245, 137.160272109, 137.462131519, 137.671111111, 137.903310658, 138.089070295, 138.901768707, 138.971428571, 139.133968254, 139.226848073, 139.621587302, 139.760907029, 139.877006803, 140.620045351, 141.595283447, 141.966802721, 142.129342404, 142.245442177, 142.338321995, 143.081360544, 143.197460317, 143.685079365, 143.940498866, 144.056598639, 144.683537415, 144.799637188, 144.892517007, 145.124716553, 145.333696145, 145.403356009, 145.65877551, 145.751655329, 146.030294785, 146.192834467, 146.471473923, 146.517913832, 146.610793651, 146.726893424, 147.051972789, 147.168072562, 147.260952381, 147.377052154, 147.469931973, 148.120090703, 148.329070295, 148.445170068, 148.979229025, 149.188208617, 150.047346939, 150.163446712, 150.697505669, 150.906485261, 151.440544218, 151.765623583, 152.25324263, 152.624761905, 152.833741497, 152.903401361, 153.065941043, 153.112380952, 153.321360544, 153.367800454, 153.460680272, 153.6, 153.90185941, 153.971519274, 154.017959184, 154.226938776, 154.343038549]

current_onset = 0
current_beat = 0

# play music
pygame.mixer.init()
pygame.mixer.music.load(INPUT_FILE)
pygame.mixer.music.play(0, 0)

# animations
MAX_BRIGTHNESS = 1.0
onset_animations = []
#onset_animations = [PeakAnimation_Core_IncreaseHue(smallSheep.get_body_indexes(), MAX_BRIGTHNESS, 0.1, 0.12),
#                    PeakAnimation_Core_IncreaseHue(flower.get_all_indexes(), MAX_BRIGTHNESS, 0.1, 0.12)]
#onset_animations = [ColoringAnimation_Core_Rainbow(smallSheep.get_body_indexes(), MAX_BRIGTHNESS, 3),
                   #AfterPeakAnimation_AddOn_BrightnessLoss(smallSheep.get_body_indexes(), 0.2)]
                   #AfterPeakAnimation_AddOn_Circle(smallSheep.get_body_indexes(), 1.5)]


beat_sheep_animations = [PeakAnimation_Core_IncreaseHue(smallSheep.get_all_indexes(), MAX_BRIGTHNESS, 0.1, 0.12)]
beat_flower_animations = [PeakAnimation_Core_IncreaseHue(flower.get_all_indexes(), MAX_BRIGTHNESS, 0.1, 0.12)]


def apply_animations(song_time):
    global current_onset
    global current_beat
    new_onset = False
    new_beat = False

    # increas current onset
    while (song_time >= onset_times[current_onset] and current_onset < len(onset_times)):
        current_onset += 1
        new_onset = True
    time_since_last_onset = song_time - onset_times[current_onset - 1]

    # increas current beat
    while (song_time >= beat_times[current_beat] and current_beat < len(beat_times)):
        current_beat += 1
        new_beat = True
    time_since_last_beat = song_time - beat_times[current_beat - 1]

    # run animations
    print ("apply_animations")
    
    for onset_animation in onset_animations:
        if (isinstance(onset_animation, PeakAnimation)):
            onset_animation.apply(new_onset, smallSheep.get_array())
            print (new_onset)
        if (isinstance(onset_animation, AfterPeakAnimation)):
            onset_animation.apply(time_since_last_onset, smallSheep.get_array())
        if (isinstance(onset_animation, ColoringAnimation)):
            onset_animation.apply(smallSheep.get_array())
   
    for beat_animation in beat_flower_animations:
        if (isinstance(beat_animation, PeakAnimation)):
            beat_animation.apply(new_beat, flower.get_array())
        if (isinstance(beat_animation, AfterPeakAnimation)):
            beat_animation.apply(time_since_last_beat, flower.get_array())
        if (isinstance(beat_animation, ColoringAnimation)):
            beat_animation.apply(flower.get_array())

    for beat_animation in beat_sheep_animations:
        if (isinstance(beat_animation, PeakAnimation)):
            beat_animation.apply(new_beat, smallSheep.get_array())
        if (isinstance(beat_animation, AfterPeakAnimation)):
            beat_animation.apply(time_since_last_beat, smallSheep.get_array())
        if (isinstance(beat_animation, ColoringAnimation)):
            beat_animation.apply(smallSheep.get_array())


# MAIN #

while pygame.mixer.music.get_busy():
        song_time = pygame.mixer.music.get_pos()
        song_time = song_time / 1000.0
        
        # run anumation
        apply_animations(song_time)

        # send data to LEDs
        simulator.draw_LEDs(smallSheep.get_array(),
                            bigSheep12.get_array(),
                            bigSheep34.get_array(),
                            signs.get_array(),
                            flower.get_array())

        clock.tick(50)

        for event in pygame.event.get():  # user did something
            if event.type == pygame.QUIT:
                done = True



